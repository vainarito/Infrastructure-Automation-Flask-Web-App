# 1. Администрирование сервера

## Общая цель

Развернуть и задокументировать инфраструктуру для простого веб-приложения, используя Linux, Bash, сетевые настройки, веб-сервер, и Ansible.

## Модули и задачи

### Подготовка сервера

- Установить виртуальную машину (можно VirtualBox/VMware) с Ubuntu/Debian или CentOS.
- Настроить пользователей и группы:
  - создать отдельного пользователя **devops** с домашней директорией;
  - дать ему доступ к *sudo*.
- Настроить базовые политики безопасности:
  - включить и настроить *ufw* или **firewalld** (разрешить только SSH и HTTP/HTTPS входящие соединения);
  - настроить SSH-доступ по ключам (пароли запретить).

### Настройка приложения

- Настроить **systemd**-сервис для тестового приложения.
  - [Репозиторий приложения](https://github.com/riad-azz/flask-auth-example)
  - Написать Bash-скрипт, который:
    1. устанавливает необходимые пакеты (*git*, *curl*, *python* и др.);
    2. проверяет, запущен ли веб-сервер и приложение, и пишет результат в лог;
    3. делает резервную копию файла базы данных (**database.db**) веб-сервера и сохраняет их с меткой даты.
  - 2 и 3 скрипты реализовать как **cron**-задачи.

### Мониторинг системы

- Настроить мониторинг состояния системы:
  - собрать базовые метрики (**uptime**, **df -h**, **top -b -n1 | head -n 20**) и сохранить в лог.
- Настроить логирование (например, **journalctl** или **rsyslog**) так, чтобы логи приложения складывались в отдельный файл.
- Реализовать ротацию логов с помощью **logrotate**.

### Веб-прокси

- Развернуть **Nginx или Apache**.
- Настроить виртуальный хост (например, **test.local**).
- Настроить обратный прокси:
  - Nginx/Apache принимает запросы на порт 80,
  - проксирует их на локальное приложение.

### Управление конфигурациями

- Написать Ansible Role, с помощью которой реализуются все предыдущие шаги, кроме создания пользователя и настройки SSH сервера.
- Настроить сервер с помощью написанной роли, под ранее созданным пользователем.
- \* Описать возможность настройки веб-сервера и прокси посредством Docker/Docker-compose, при передаче Ansible playbook соответствующих параметров.

## Результат выполнения

- Рабочий сервер с доступом к веб-приложению через HTTP.
- Репозиторий с кодом:
  - README.md с описанием шагов запуска.
  - Структурированные роль и плейбук Ansible.
  - Архитектурная схема (простая: сервер, приложение, веб-сервер, firewall).
  - Краткая инструкция для тестирования.
